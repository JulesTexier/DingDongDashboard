
    <% if !@subscriber.broker.nil?%>
    <script>
      function showForm() {
        document.getElementById("form").style.display = "block";
      }
      // setTimeout("showForm()", 55000); 
      setTimeout("showForm()", 1000); // after 1 sec
    </script>
        <h4 class="text-center mt-4" style="color: #0470C1; font-weight:400"><b>👇 Comment Ding Dong va t'accompagner dans ton projet ? 👇</b></h4>
        <h4 class="text-center mt-4" style="color: #0470C1; font-weight:400">Tu auras accès à l'alerte dès la fin de cette vidéo</h6>
        <div class="d-flex justify-content-center mt-3 ">
           <iframe width="560" height="315" src="https://www.youtube.com/embed/o9vx2SkUC58?autoplay=1" frameborder="0" allow="accelerometer; autoplay=1; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
        <div id="form" style="display:none">
          <%= form_tag('/subscribed-update') do |f| %>
          <div class="row">
            <div class="col-12">
              <h5 class="mt-4 mb-3" style="color: #0470C1; font-weight:400">Audit de votre situation financière offerte</h5>
              <div class="form-check form-check-inline">
                <%= check_box_tag 'free_financial_plan', 'true', true, class:"form-check-input" %>
                <label class="form-check-label" for= "free_financial_plan"> Je souhaite être contacté pour un audit financier de ma situation</label>
              </div>
              <p class="mt-2"><i> NB : Notre expert négocie les meilleurs taux tous les mois en partenariat avec toutes les banques du marché, il pourra vous donner rapidement une estimation de votre capacité d'emprunt maximale et de votre taux d’intérêt minimal !</i></p>
            </div>
          </div>
          <div class="row">
            <div class="col-12">
              <h6 class="mt-4 mb-3" style="color: #0470C1; font-weight:400">Quand souhaitez vous être recontacté ?</h6>
              
              <%# Shift %>
              <div class="d-flex flex-wrap">
                <%= select_tag "shift", options_for_select(@shifts), class:"form-control" %>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-12">
          <%# Services %>
              <h5 class="mt-4 mb-3" style="color: #0470C1; font-weight:400">De quels services pourriez vous avoir besoin ?</h5>
                <div class="d-flex flex-wrap">
                <% @services.each do |service| %>
                  <label 
                  for="<%=service%>"
                  class="form-check mr-3 mb-2 <%=service%> d-flex checkbox-button box_hover label_non_active"
                  onclick="changeColorCheckbox(className)"
              >       <div>
                          <%= check_box_tag 'services[]', 
                              service, 
                              false, 
                              class: "checkbox-button-input box_hover",
                              style: "display : none",
                              id: service
                          %>
                      </div>
                      <div>
                          +
                  </div>
                  <span class="form-check-label mb-2 ml-1 box_hover" >
                    <%= service %>
                  </span>
                </label>
              <% end %>
              </div>
            </div>
          </div>
          <div class="row mt-4">
            <div class="col-12 d-flex justify-content-center">
            <%= hidden_field_tag 'id', @subscriber.id  %>
            <nav class="navbar navbar-light fixed-bottom d-flex justify-content-center bg-blue">
              <div class="d-flex justify-content-center mt-2 mb-2">
                <%= submit_tag "Essayer gratuitement ! 🚀", :name => 'commit', class: "btn btn-outline-light", style:"font-weight:600" %>
              </div>
            </nav>
            </div>
          </div>
          <% end %>
        </div>


    
        <div class="d-flex justify-content-center mt-4 mb-6">
        🧡
        </div>
        </p>
    <% elsif !@subscriber.has_messenger %>
        <h4 class="text-center mt-4" style="color: #0470C1; font-weight:400">Malheureusement, notre alerte n'est disponible que sur messenger pour le moment 😥</h4>
        <h5 class="text-center mt-4" style="color: #0470C1; font-weight:400">Nous vous avons envoyé un mail 📧 pour plus d'explications.</h5>
        <h5 class="text-center mt-4" style="color: #0470C1; font-weight:400">A bientôt 🚀</h5>
    <% elsif @subscriber.project_type == "Chasseur Immobilier" %>
        <h4 class="text-center mt-4" style="color: #0470C1; font-weight:400">Vous avez indiqué être un chasseur immobilier 🙂</h4>
         <h5 class="text-center mt-4" style="color: #0470C1; font-weight:400"> Nous sommes désolés mais notre alerte n'est pas encore disponible pour de la multi-recherche. Nous sommes en train de travailler sur un produit spécialement dédié à vos besoins, nous vous tiendrons informé !</h5>
    <% elsif @subscriber.status == "duplicates" %>
        <h4 class="text-center mt-4" style="color: #0470C1; font-weight:400">🤔 Nous avons déjà enregistré une demande d'inscription à notre service avec votre adresse mail. </h4>
        <h5 class="text-center mt-4" style="color: #0470C1; font-weight:400">S'il s'agit d'une erreur, répondez simplement au mail 📧 que vous venez de recevoir 🙂 </h5>
    <% end %>


<script>

    function areasChecked(){
      let checkboxes = document.querySelectorAll('input[type="checkbox"]')
      let checkedOne = Array.prototype.slice.call(checkboxes).some(x => x.checked);
      if (!checkedOne) {
        alert('Sélectionnez au moins un quartier 📍')
      }
    }
    function changeColorCheckbox(className) {
      let label = document.getElementsByClassName(className)[0]
      let image = label.children[1]
      let checkboxValue = label.children[0].children[0].checked
      if(checkboxValue){ 
          image.innerHTML = "👌";
          label.classList.remove('label_non_active')
          label.className += " label_active"
        }
      else{
          image.innerHTML = "+";
          label.classList.remove('label_active')
          label.className += " label_non_active"
        }
    }

    function selectAll(className) {
        let all_labels = document.getElementsByClassName(className)
        let all_label = document.getElementsByClassName("checkbox-allbutton-label")

        if(all_labels[0].checked){
          all_label[0].innerHTML = "🌟Tous / Aucun"
          all_label[0].parentNode.classList.remove('label_non_active')
          all_label[0].parentNode.className += " label_active"
            for(i=1; i < all_labels.length; i++){
                all_labels[i].checked = true;
                all_labels[i].parentNode.parentNode.classList.remove('label_non_active')
                all_labels[i].parentNode.parentNode.className += " label_active"
                all_labels[i].parentNode.nextElementSibling.innerHTML = "👌"
            }
        }
        else{
          all_label[0].innerHTML = "+ Tous / Aucun"
          all_label[0].parentNode.classList.remove('label_active')
          all_label[0].parentNode.className += " label_non_active"
            for(i=1; i < all_labels.length; i++){
                all_labels[i].checked = false;
                all_labels[i].parentNode.parentNode.classList.remove('label_active')
                all_labels[i].parentNode.parentNode.className += " label_non_active"
                all_labels[i].parentNode.nextElementSibling.innerHTML = "+"
            }
        }
    }

    function changeColorRadioButton(className) {
      let labels = document.getElementsByClassName("radio-button")
      let item = document.getElementsByClassName(className)[0]
      let checkboxValue = item.children[0].children[0].checked
    
      if(checkboxValue){ 
          for(i=0; i < labels.length; i++){
              labels[i].classList.remove('label_active')
              labels[i].className += " label_non_active"
          }
          item.classList.remove('label_non_active')
          item.className += " label_active"
        }
    }


</script>






